var frederickkPaper=frederickkPaper||{};(function(){console.log("\nfrederickkPaper.js");console.log("v.0.3a");console.log("https://github.com/frederickk/frederickkPaper");console.log("ken.frederick@gmx.de");console.log("------------------------------------\n")})();frederickkPaper={FIO:{},F3D:{},FShape:{},FTime:{},random:function(b,a){if(a===undefined){a=b;b=0}return(b+Math.random()*(a-b))},randomInt:function(b,a){return parseInt(frederickkPaper.random(b,a))},randomBias:function(d,c,a){var e=new Array(90,9,4,2.33,1.5,1,0.66,0.43,0.25,0.11,0.01);a=Math.max(0,Math.min(a,1))*10;var b=parseInt(Math.floor(a));var g=e[b];if(a<10){g+=(e[b+1]-g)*(a-b)}return Math.pow(Math.random(),g)*(c-d)+d},clamp:function(c,b,a){return c<b?b:c>a?b:c},norm:function(b,c,a){return(b-c)/(a-c)},map:function(d,b,c,a,e){return a+(e-a)*((d-b)/(c-b))},roundDecimal:function(c,a){var b=Math.pow(10,a);return Math.round(c*b)/b},snap:function(b,a,c){if(c===undefined){c=Math.round}return a*c(b/a)},lerp:function(c,a,b){return a+(c-a)*b},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},getAngle:function(b,a){return Math.atan2(a.y-b.y,a.x-b.x)*180/Math.PI},getCommonTangents:function(g,d){var n=d.position.x-g.position.x;var m=d.position.y-g.position.y;var b=Math.sqrt(g.bounds.size.area());var a=Math.sqrt(d.bounds.size.area());b/=2;a/=2;var h=g.position.getDistance(d.position);if(h<=Math.abs(a-b)){return}var e=Math.atan2(m,n);var c=Math.acos((b-a)/h);var l=new Point(g.position.x+b*Math.cos(e+c),g.position.y+b*Math.sin(e+c));var k=new Point(d.position.x+a*Math.cos(e+c),d.position.y+a*Math.sin(e+c));var i=new Point(g.position.x+b*Math.cos(e-c),g.position.y+b*Math.sin(e-c));var j=new Point(d.position.x+a*Math.cos(e-c),d.position.y+a*Math.sin(e-c));return[l,k,j,i]},sq:function(a){return a*a},boolToInt:function(a){return(a)?1:0},getType:function(a){if(a instanceof paper.Point){return"Point"}else{if(a instanceof paper.Size){return"Size"}else{if(a instanceof paper.Rectangle){return"Rectangle"}else{if(a instanceof Group){return"Group"}else{if(a instanceof paper.PlacedItem){return"PlacedItem"}else{if(a instanceof paper.Raster){return"Raster"}else{if(a instanceof paper.PlacedSymbol){return"PlacedSymbol"}else{if(a instanceof paper.Path){return"Path"}else{if(a instanceof paper.CompoundPath){return"CompoundPath"}else{if(a instanceof paper.Symbol){return"Symbol"}else{if(a instanceof paper.TextItem){return"TextItem"}else{return"undefined"}}}}}}}}}}}},findByName:function(a,b){var e;for(var c=0;c<a.length;c++){var d=a[c];if(d.name==b){e=d}}return e},trimToFit:function(a){var b=a.visibleRange.content;a.content=trim(b);return a},rtrim:function(b){for(var a=b.length-1;b.charAt(a)==" ";a--){b=b.substring(0,a)}return b},trim:function(a){a=a.replace(/(^\s*)|(\s*$)/gi,"");a=a.replace(/[ ]{2,}/gi," ");a=a.replace(/\n /,"\n");return a},strToBool:function(a){switch(a.toLowerCase()){case"true":case"yes":case"1":return true;case"false":case"no":case"0":case null:return false;default:return Boolean(a)}},merge:function(c,b){var a=c.concat(b);a.shuffle();return a},alphabetical:function(d,c){d=d.toLowerCase();d=d.replace(/ä/g,"a");d=d.replace(/ö/g,"o");d=d.replace(/ü/g,"u");d=d.replace(/ß/g,"s");c=c.toLowerCase();c=c.replace(/ä/g,"a");c=c.replace(/ö/g,"o");c=c.replace(/ü/g,"u");c=c.replace(/ß/g,"s");return(d==c)?0:(d>c)?1:-1},distanceToCenter:function(d,c){var h=d.distanceToCenter();var g=c.distanceToCenter();var e=0;if(h>g){e=-1}else{if(h<g){e=1}}return e}};Array.prototype.max=function(g,d){var e=(g!=undefined)?g:0;var b=(d!=undefined)?d:this.length;var a=this[e];for(var c=(e+1);c<b;c++){if(this[c]>a){a=c}}return a};Array.prototype.min=function(g,d){var e=(g!=undefined)?g:0;var a=(d!=undefined)?d:this.length;var c=this[e];for(var b=(e+1);b<a;b++){if(this[b]<c){c=b}}return c};Array.prototype.shuffle=function(){for(var b,a,c=this.length;c;b=parseInt(Math.random()*c),a=this[--c],this[c]=this[b],this[b]=a){}};paper.inject({EPSILON:0.000001,});paper.Point.inject({norm:function(a,b){this.x=frederickkPaper.norm(this.x,start.x,stop.x);this.y=frederickkPaper.norm(this.y,start.y,stop.y);return this},random:function(b,a){this.x=(b!=undefined)?frederickkPaper.random(b[0],b[1]):Math.random()*view.bounds.width;this.y=(a!=undefined)?frederickkPaper.random(a[0],a[1]):Math.random()*view.bounds.height;return this},heading:function(){return -1*(Math.atan2(-this.y,this.x))},interpolateTo:function(b,a){this.x+=((b.x-this.x)*a);this.y+=((b.y-this.y)*a);return this},lerp:function(d,c,b){var a,e;if(typeof c==="number"){a=frederickkPaper.lerp(this.x,d.x,c);e=frederickkPaper.lerp(this.y,d.y,c)}else{a=frederickkPaper.lerp(d.x,c.x,b);e=frederickkPaper.lerp(d.y,c.y,b)}return new Point(a,e)},limit:function(a){if(this.magSq()>a*a){this.normalize();this.mult*a;return this}return this},magSq:function(){return this.x*this.x+this.y*this.y},snapGrid:function(c){var b,a;b=Math.round(this.y/c.height-this.x/c.width);a=Math.round(this.y/c.height+this.x/c.width);this.x=(a-b)/2*c.width;this.y=(a+b)/2*c.height;return this},snapIso:function(a){if(a===null){a=1}return this.snapGrid(new Size(32*a,16*a))},getAngle:function(){return Math.atan2(this.y-0,this.x-0)}});paper.Size.inject({random:function(a,d,c,b){a=(a!=undefined)?a:0;d=(d!=undefined)?d:view.bounds.width;c=(c!=undefined)?c:0;b=(b!=undefined)?b:view.bounds.height;this.width=frederickkPaper.random(a,d);this.height=frederickkPaper.random(c,b);return this},area:function(){return(this.width*this.height)},radius:function(){var d=this.width;var c=this.height;return(Math.sqrt(d*d+c*c)/2)}});paper.Color.inject({darken:function(a){this.red-=a;this.green-=a;this.blue-=a;return this},lighten:function(a){this.red+=a;this.green+=a;this.blue+=a;return this},lerp:function(m,k,i){var c,j,n,e,p,d,o;if(m.getType()=="gray"||this.getType()=="gray"){if(typeof k==="number"){j=frederickkPaper.lerp(this.gray,m.gray,k);o=frederickkPaper.lerp(this.alpha,m.alpha,k)}else{j=frederickkPaper.lerp(m.gray,k.gray,i);o=frederickkPaper.lerp(m.alpha,k.alpha,i)}return new GrayColor(j,o)}else{if(m.getType()=="rgb"||this.getType()=="rgb"){if(typeof k==="number"){c=frederickkPaper.lerp(this.red,m.red,k);j=frederickkPaper.lerp(this.green,m.green,k);n=frederickkPaper.lerp(this.blue,m.blue,k);o=frederickkPaper.lerp(this.alpha,m.alpha,k)}else{c=frederickkPaper.lerp(m.red,k.red,i);j=frederickkPaper.lerp(m.green,k.green,i);n=frederickkPaper.lerp(m.blue,k.blue,i);o=frederickkPaper.lerp(m.alpha,k.alpha,i)}return new RgbColor(c,j,n,o)}else{if(m.getType()=="hsl"||this.getType()=="hsl"){if(typeof k==="number"){e=frederickkPaper.lerp(this.hue,m.hue,k);p=frederickkPaper.lerp(this.saturation,m.saturation,k);d=frederickkPaper.lerp(this.lightness,m.lightness,k);o=frederickkPaper.lerp(this.alpha,m.alpha,k)}else{e=frederickkPaper.lerp(m.hue,k.hue,i);p=frederickkPaper.lerp(m.saturation,k.saturation,i);d=frederickkPaper.lerp(m.lightness,k.lightness,i);o=frederickkPaper.lerp(m.alpha,k.alpha,i)}return new HslColor(e,p,d,o)}else{if(m.getType()=="hsb"||this.getType()=="hsb"){if(typeof k==="number"){e=frederickkPaper.lerp(this.hue,m.hue,k);p=frederickkPaper.lerp(this.saturation,m.saturation,k);n=frederickkPaper.lerp(this.brightness,m.brightness,k);o=frederickkPaper.lerp(this.alpha,m.alpha,k)}else{e=frederickkPaper.lerp(m.hue,k.hue,i);p=frederickkPaper.lerp(m.saturation,k.saturation,i);n=frederickkPaper.lerp(m.brightness,k.brightness,i);o=frederickkPaper.lerp(m.alpha,k.alpha,i)}return new HsbColor(e,p,n,o)}}}}},componentToHex:function(a){var b=a.toString(16);return b.length==1?"0"+b:b},colorToHex:function(){var e,d,a;var h="";try{e=this.red*255;d=this.green*255;a=this.blue*255;h="#"+this.componentToHex(e)+this.componentToHex(d)+this.componentToHex(a)}catch(c){console.log(c)}return h},hex:function(b){if(b.length>=7){b=b.split("#")[1]}else{b=b}var a=parseInt(b,16);this.red=((a>>16)&255)/255;this.green=((a>>8)&255)/255;this.blue=(a&255)/255;return this},colorToInt:function(){var a;try{a=this.red;a=a<<8;a|=this.green;a=a<<8;a|=this.blue}catch(b){console.log(b);a=16777215}return a},integer:function(a){this.red=(a>>16)&255;this.green=(a>>8)&255;this.blue=a&255;return this},bytes:function(d,c,b,a){this.red=d/255;this.green=(c!=undefined)?c/255:d/255;this.blue=(b!=undefined)?b/255:d/255;this.alpha=(a!=undefined)?a/255:1;return this}});GrayColor.inject({random:function(b,a){this.gray=(b!=undefined)?frederickkPaper.random(b[0],b[1]):Math.random();this.alpha=(a!=undefined)?frederickkPaper.random(a[0],a[1]):Math.random();return this}});paper.RgbColor.inject({random:function(d,c,b,a){this.red=Math.random();this.green=Math.random();this.blue=Math.random();this.alpha=(a!=undefined)?frederickkPaper.random(a[0],a[1]):Math.random();return this}});paper.HslColor.inject({random:function(d,c,b,a){this.hue=(d!=undefined)?frederickkPaper.random(d[0],d[1]):Math.random()*360;this.saturation=(c!=undefined)?frederickkPaper.random(c[0],b[1]):Math.random();this.lightness=(b!=undefined)?frederickkPaper.random(c[0],b[1]):Math.random();this.alpha=(a!=undefined)?frederickkPaper.random(a[0],a[1]):Math.random();return this}});paper.HsbColor.inject({random:function(d,c,b,a){this.hue=(d!=undefined)?frederickkPaper.random(d[0],d[1]):Math.random()*360;this.saturation=(c!=undefined)?frederickkPaper.random(c[0],b[1]):Math.random();this.brightness=(b!=undefined)?frederickkPaper.random(c[0],b[1]):Math.random();this.alpha=(a!=undefined)?frederickkPaper.random(a[0],a[1]):Math.random();return this}});frederickkPaper.FColor=function(){this.lerp=function(d,c,b){return d.lerp(c,b)};this.randomRGBColor=function(){return new RgbColor().random()};this.randomGrayColor=function(){return new new GrayColor().random()};var a=function(b){return Color().componentToHex(b)};this.colorToHex=function(b){return b.colorToHex()};this.hex=function(b){return new RgbColor().hexToColor(b)};this.colorToInt=function(b){return b.colorToInt()};this.integer=function(b){return new RgbColor().intToColor()};this.bytes=function(e,d,c,b){return new RgbColor().bytes(e,d,c,b)}};frederickkPaper.FConversions=function(){this.ptToMm=0.352777778;this.mmToPt=2.83464567;this.ptToCm=0.0352777778;this.CmToPt=28.3464567;this.ptToIn=0.0138888889;this.inToPt=72;this.ptToPi=0.0833333333;this.piToPt=12};frederickkPaper.FIO={saveLocal:function(a,b){if(window.localStorage){localStorage.setItem(a,String(b))}else{console.error("localStorage not supported")}},getLocal:function(a){return localStorage.getItem(a)},getLocalInt:function(a){return parseInt(getLocal(a))},getLocalFloat:function(a){return parseFloat(getLocal(a))},getAllLocal:function(){return sessionStorage},deleteLocal:function(a){localStorage.removeItem(a)},saveSession:function(a,b){if(window.sessionStorage){sessionStorage.setItem(a,String(b))}else{console.error("sessionStorage not supported")}},getSession:function(a){return sessionStorage.getItem(a)},getSessionInt:function(a){return parseInt(getSession(a))},getSessionFloat:function(a){return parseFloat(getSession(a))},getAllSession:function(){return sessionStorage},deleteSession:function(a){sessionStorage.removeItem(a)},saveCookie:function(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+d+a+"; path=/"},openCookie:function(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var g=a[d];while(g.charAt(0)==" "){g=g.substring(1,g.length)}if(g.indexOf(e)==0){return g.substring(e.length,g.length)}}return null},deleteCookie:function(a){saveCookie(a,"",-1)}};frederickkPaper.FTime.FDate=function(){this.date;var b=["January","February","March","April","May","June","July","August","September","October","November","December"];var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var c=function(d){if(d.length==1){d="0"+d}return d};this.year=function(){if(this.date===undefined){this.date=new Date()}var d=String(this.date.getFullYear());return d};this.month=function(){if(this.date===undefined){this.date=new Date()}var d=String(this.date.getMonth());hour=c(d);return d};this.day=function(){if(this.date===undefined){this.date=new Date()}var d=String(this.date.getDate());return d};this.hour=function(){if(this.date===undefined){this.date=new Date()}var d=String(this.date.getHours());d=c(d);return d};this.minute=function(){if(this.date===undefined){this.date=new Date()}var d=String(this.date.getMinutes());d=c(d);return d};this.second=function(){if(this.date===undefined){this.date=new Date()}var d=String(this.date.getSeconds());d=c(d);return d};this.now=function(e){var d=[];if(e===undefined){d=[true,true,true]}else{d=e}var g="";if(d[0]){g+=this.hour()}if(d[0]&&d[1]){g+=":"}if(d[1]){g+=this.minute()}if(d[1]&&d[2]){g+=":"}if(d[2]){g+=this.second()}return g};this.nowMilliseconds=function(){return this.toMillsecond(this.hour(),this.minute(),this.second())};this.add=function(d,h,e,g){return this.date+(24*d+60*h+60*e+1000*s)};this.sub=function(d,h,e,g){return this.date-(24*d+60*h+60*e+1000*s)};this.set=function(d,h,e,g){this.time=new Date();this.time.setTime((24*d+60*h+60*e+1000*s));return this.time};this.get=function(d,l){var m;if(l===undefined){m=new Array(true,true,true)}else{m=l}var k=parseInt((d/1000)%60);var h=parseInt(((d/1000)/60)%60);var j=parseInt((((d/1000)/60)/60)%24);var e,g,n;if(j<10){e="0"+j}else{e=""+j}if(h<10){g="0"+h}else{g=""+h}if(k<10){n="0"+k}else{n=""+k}var i="";if(m[0]){i+=e}if(m[0]&&m[1]){i+=":"}if(m[1]){i+=g}if(m[1]&&m[2]){i+=":"}if(m[2]){i+=n}return i};this.toMillsecond=function(k,e,j){var i,d,g;if(e===undefined&&j===undefined){i=this.toArray(k)[0];d=this.toArray(k)[1];g=this.toArray(k)[2]}else{i=k;d=e;g=j}return parseInt(3600000*i+60000*d+1000*g)};this.toArray=function(d){var e=d.split(":");return[e[0],e[1],e[2]]}};frederickkPaper.FTime.FStepper=function(){var e=1000;var g=0;var i=0;var k=0;var j=false;var c=false;var h=false;var d=true;var a=0.05;var b=true;this.delta=1;this.counter=-1;this.toggle=function(){if(k==0){k=1;this.stepOut()}else{k=0;this.stepIn()}};this.update=function(l){if(j){j=false;g=l;if(c){i=frederickkPaper.roundDecimal((l+((1-this.delta)*e)),3)}else{i=frederickkPaper.roundDecimal((l+(this.delta*e)),3)}if(i<=l){if(c){c=false;this.delta=1}else{h=false;this.delta=0}}}if(c){this.delta=frederickkPaper.roundDecimal((1-((i-l)/e)),3);if(l==i){c=false;this.delta=1;this.counter++;return}}else{if(h){this.delta=frederickkPaper.roundDecimal(((i-l)/e),3);if(l==i){c=false;this.delta=0;this.counter++;return}}}};this.stepIn=function(){if(c){return}if(this.delta==1){return}j=true;c=true;h=false};this.stepOut=function(){if(h){return}if(this.delta==0){return}j=true;h=true;c=false};this.isIn=function(){return c};this.isOut=function(){return h};this.isDone=function(){if(this.delta<1&&this.delta>0){return false}else{if(this.delta>=1){this.delta=1;return true}else{if(this.delta<=0){this.delta=0;return true}}}};this.stop=function(){j=c=h=false};this.setSeconds=function(l){this.setMillis(parseInt(l*1000))};this.setMillis=function(l){e=l;e/=1000};this.setDelta=function(l){this.delta=l}};frederickkPaper.FTime.FStopwatch=function(){var c;var d;var b=0;var a=0;this.toggle=function(){if(a==0){this.start()}else{this.pause()}};this.start=function(){a=1;d=new Date();d.setTime(d.getTime()-b)};this.pause=function(){a=0;c=new Date();b=c.getTime()-d.getTime()};this.reset=function(){a=0;b=0};this.set=function(e,g){b=e;(g==true)?a=0:a=1;d=new Date();d.setTime(d.getTime()-b);this.toggle()};this.get=function(){if(a==1){c=new Date();b=c.getTime()-d.getTime()}return b};this.isRunning=function(){return(a)?true:false}};frederickkPaper.F3D.FPath3=this.FPath3=Path.extend({_type:"FPath3",_scene:null,_matrix:null,_fpoints3:null,_rotation:null,_translation:null,position3:null,initialize:function(a){this.base();this._closed=false;this.position3=new frederickkPaper.F3D.FPoint3();this._scene=a;this._matrix=new Matrix3D();this._rotation=new frederickkPaper.F3D.FPoint3();this._translation=new frederickkPaper.F3D.FPoint3();this._fpoints3=[];this.name="FPath3"},setScene:function(b){this._scene=b;for(var a=0;a<this._fpoints3.length;a++){this._fpoints3[a].setup(this._scene)}},add3:function(a){this._fpoints3[this._fpoints3.length]=a},translate:function(d,b,a){if(typeof d=="number"){this._translation.x=d;this._translation.y=b;this._translation.z=a}else{if(typeof d=="object"){this._translation.x=d.x;this._translation.y=b.y;this._translation.z=a.z}else{this._translation.x=d!=undefined?d:0;this._translation.y=b!=undefined?b:0;this._translation.z=a!=undefined?a:0}}for(var c=0;c<this._fpoints3.length;c++){var e=this._fpoints3[c];e.setX((e.x+this._translation.x));e.setY((e.y+this._translation.y));e.setZ((e.z+this._translation.z))}},rotateX:function(a){this._rotation.x=a},rotateY:function(a){this._rotation.y=a},rotateZ:function(a){this._rotation.z=a},get:function(){this._segments=[];for(var a=0;a<this._fpoints3.length;a++){var b=this._fpoints3[a];this.add(new Point(b.x2D(),b.y2D()))}return this},});frederickkPaper.F3D.FPoint3=this.FPoint3=function(e,d,c){var h=null;var g=0;var j=0;var a=0;var i=0;var b=0;this.x=e!=undefined?e:0;this.y=d!=undefined?d:0;this.z=c!=undefined?c:0;this.setup=function(n){h=n;var k=h.setupPoint(this.x,this.y,this.z);var l=k*3;var m=k*2;g=l;j=l+1;a=l+2;i=m;b=m+1};this.random=function(l,o,k,n,p,m){l=(l!=undefined)?l:0;o=(o!=undefined)?o:view.bounds.width;k=(k!=undefined)?k:0;n=(n!=undefined)?n:view.bounds.height;p=(p!=undefined)?k:0;m=(m!=undefined)?n:1000;this.x=frederickkPaper.random(l,o);this.y=frederickkPaper.random(k,n);this.z=frederickkPaper.random(p,m);return new frederickkPaper.F3D.FPoint3(this.x,this.y,this.z)};this.setX=function(k){if(h!=null){h.points3D[g]=k}this.x=k};this.setY=function(k){if(h!=null){h.points3D[j]=k}this.y=k};this.setZ=function(k){if(h!=null){h.points3D[a]=k}this.z=k};this.set=function(m,l,k){this.setX(m);this.setY(l);this.setZ(k)};this.get=function(){return new frederickkPaper.F3D.FPoint3(this.x,this.y,this.z)};this.x2D=function(){return h.points2D[i]};this.y2D=function(){return h.points2D[b]};this.getSceneIndex=function(){return _sceneIndex};this.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};this.add=function(m,l,k){if(typeof m=="number"){this.x+=m;this.y+=l;this.z+=k}else{if(typeof m=="object"){this.x+=m.x();this.y+=m.y();this.z+=m.z()}}this.set(this.x,this.y,this.z)};this.sub=function(m,l,k){if(typeof m=="number"){this.x-=m;this.y-=l;this.z-=k}else{if(typeof m=="object"){this.x-=m.x();this.y-=m.y();this.z-=m.z()}}this.set(this.x,this.y,this.z)};this.scale=function(k){this.x*=k;this.y*=k;this.z*=k;this.set(this.x,this.y,this.z)};this.mult=function(m,l,k){if(typeof m=="number"){this.x*=m;this.y*=l;this.z*=k}else{if(typeof m=="object"){this.x*=m.x();this.y*=m.y();this.z*=m.z()}}this.set(this.x,this.y,this.z)};this.div=function(m,l,k){if(typeof m=="number"){this.x/=m;this.y/=l;this.z/=k}else{if(typeof m=="object"){this.x/=m.x();this.y/=m.y();this.z/=m.z()}}this.set(this.x,this.y,this.z)};this.getDistance=function(n){var m=this.x-n.x();var l=this.y-n.y();var k=this.z-n.z();return Math.sqrt(m*m+l*l+k*k)};this.angleBetween=function(o,n){var l=o.x()*n.x()+o.y()*n.y()+o.z()*n.z();var m=Math.sqrt(o.x()*o.x()+o.y()*o.y()+o.z()*o.z());var k=Math.sqrt(n.x()*n.x()+n.y()*n.y()+n.z()*n.z());return Math.acos(l/(m*k))};this.normalize=function(){var k=this.mag();if(k!=0&&k!=1){this.div(k)}};this.toString=function(){return"[ "+this.x+", "+this.y+", "+this.z+" ]"};this.array=function(){return[this.x,this.y,this.z]}};frederickkPaper.F3D.FScene3D=this.FScene3D=function(){var b="PERSPECTIVE";var c=null;var g=new frederickkPaper.F3D.FSize3(0,0,0);var i=1;var d=new frederickkPaper.F3D.FPoint3(0,0,0);var h=0;var e=null;var j=null;var k=null;this.bounds=new frederickkPaper.F3D.FSize3(0,0,0);this.points3D=[];this.points2D=[];this._ortho=function(){c.makeOrtho(-g.height,g.height,g.height,-g.height,-g.height,g.height)};this._perspective=function(){c.makePerspective(50,0.5*this.bounds.width/this.bounds.height,g.depth,this.bounds.depth*2)};this.setup=function(m,l,n,o){this.points3D=[];this.points2D=[];e=[];c=new Matrix3D();this.bounds.width=m||paper.view.bounds.width;this.bounds.height=l||paper.view.bounds.height;this.bounds.depth=n||1000;g.width=this.bounds.width*0.5;g.height=this.bounds.height*0.5;g.depth=this.bounds.depth*0.5;this.setMode(o);j=new Group();k=new Group()};this.draw=function(){c.identity();if(b=="ORTHO"){this._ortho()}else{this._perspective()}c.scale(i,i,i);c.rotateX(d.x);c.rotateY(d.y);c.rotateZ(d.z);c.translate(0,0,this.bounds.depth);var r=c.transformArray(this.points3D);for(var t=0;t<h;t++){var o=t*3;var q=t*2;var A=r[o];var w=r[o+1];var v=r[o+2];var p=this.bounds.depth/(v+this.bounds.depth);this.points2D[q]=A*p+g.width;this.points2D[q+1]=w*p+g.height}var m=0;var u=[];for(var t=0;t<e.length;t++){var l=e[t];var n=this.averageZ(r,m,m+(l._fpoints3.length*3));var B={index:t,z:n};u.push(B);m+=(l._fpoints3.length*3)-1}u.sort(a);j.removeChildren();k.removeChildren();for(var t=0;t<u.length;t++){var C=e[u[t].index].get();if(C.name=="Z-TOP"){k.appendTop(C)}else{if(C.name=="Z-BOTTOM"){j.appendTop(C)}else{if(C!=null){j.appendTop(C)}}}}if(b=="ORTHO"){k.scale(200,j.position);j.scale(200,j.position)}return new Group(j,k)};this.setupPoint=function(n,m,l){var o=h;this.points2D[this.points2D.length]=0;this.points2D[this.points2D.length]=0;this.points3D[this.points3D.length]=n;this.points3D[this.points3D.length]=m;this.points3D[this.points3D.length]=l;h++;return o};this.averageZ=function(q,p,o){var l=0;for(var n=p;n<o;n+=2){l+=parseInt(q[n+2])}var m=(o-p)/3;return l/m};function a(m,l){if(m.z<l.z){return -1}if(m.z>l.z){return 1}return 0}this.setMode=function(l){b=l!=undefined?l:"PERSPECTIVE"};this.addItem=function(m){if(m.length>0){for(var l=0;l<m.length;l++){e[e.length]=m[l];m[l].setScene(this)}}else{e[e.length]=m;m.setScene(this)}};this.rotateX=function(l){d.setX(l)};this.rotateY=function(l){d.setY(l)};this.rotateZ=function(l){d.setZ(l)};this.get=function(){return j};this.getBounds=function(){return[this.bounds.width,this.bounds.height,this.bounds.depth]};this.getMatrix=function(){return c};this.getFocalLength=function(){return this.bounds.depth};this.getScale=function(){return i}};frederickkPaper.F3D.FSize3=this.FSize3=function(c,b,a){this.width=c!=undefined?c:0;this.height=b!=undefined?b:0;this.depth=a!=undefined?a:0;this.setWidth=function(d){this.width=d};this.setHeight=function(d){this.height=d};this.setDepth=function(d){this.depth=d};this.set=function(g,e,d){this.setWidth(g);this.setHeight(e);this.setDepth(d)};this.get=function(){return new frederickkPaper.F3D.FSize3(this.width,this.height,this.depth)};this.random=function(d,j,g,e,i,h){d=(d!=undefined)?d:0;j=(j!=undefined)?j:view.bounds.width;g=(g!=undefined)?g:0;e=(e!=undefined)?e:view.bounds.height;i=(i!=undefined)?i:0;h=(h!=undefined)?h:1000;this.width=frederickkPaper.random(d,j);this.height=frederickkPaper.random(g,e);this.depth=frederickkPaper.random(i,h);return this};this.volume=function(){return(this.width*this.height*this.depth)}};var Matrix3D=function(n,m,k,i,e,d,c,b,a,q,p,o,l,j,h,g){this.n11=n||1;this.n12=m||0;this.n13=k||0;this.n14=i||0;this.n21=e||0;this.n22=d||1;this.n23=c||0;this.n24=b||0;this.n31=a||0;this.n32=q||0;this.n33=p||1;this.n34=o||0;this.n41=l||0;this.n42=j||0;this.n43=h||0;this.n44=g||1;this.clone=function(){return new Matrix3D(this.n11,this.n12,this.n13,this.n14,this.n21,this.n22,this.n23,this.n24,this.n31,this.n32,this.n33,this.n34,this.n41,this.n42,this.n43,this.n44)};this.concat=function(r){var t={};t.n11=this.n11*r.n11+this.n12*r.n21+this.n13*r.n31+this.n14*r.n41;t.n12=this.n11*r.n12+this.n12*r.n22+this.n13*r.n32+this.n14*r.n42;t.n13=this.n11*r.n13+this.n12*r.n23+this.n13*r.n33+this.n14*r.n43;t.n14=this.n11*r.n14+this.n12*r.n24+this.n13*r.n34+this.n14*r.n44;t.n21=this.n21*r.n11+this.n22*r.n21+this.n23*r.n31+this.n24*r.n41;t.n22=this.n21*r.n12+this.n22*r.n22+this.n23*r.n32+this.n24*r.n42;t.n23=this.n21*r.n13+this.n22*r.n23+this.n23*r.n33+this.n24*r.n43;t.n24=this.n21*r.n14+this.n22*r.n24+this.n23*r.n34+this.n24*r.n44;t.n31=this.n31*r.n11+this.n32*r.n21+this.n33*r.n31+this.n34*r.n41;t.n32=this.n31*r.n12+this.n32*r.n22+this.n33*r.n32+this.n34*r.n42;t.n33=this.n31*r.n13+this.n32*r.n23+this.n33*r.n33+this.n34*r.n43;t.n34=this.n31*r.n14+this.n32*r.n24+this.n33*r.n34+this.n34*r.n44;t.n41=this.n41*r.n11+this.n42*r.n21+this.n43*r.n31+this.n44*r.n41;t.n42=this.n41*r.n12+this.n42*r.n22+this.n43*r.n32+this.n44*r.n42;t.n43=this.n41*r.n13+this.n42*r.n23+this.n43*r.n33+this.n44*r.n43;t.n44=this.n41*r.n14+this.n42*r.n24+this.n43*r.n34+this.n44*r.n44;this.initialize(t)};this.initialize=function(r){for(var t in r){this[t]=r[t]}};this.createBox=function(A,y,w,u,t,r,z,x,v){this.identity();if(u!=0){this.rotateX(u)}if(t!=0){this.rotateY(t)}if(r!=0){this.rotateZ(r)}if(A!=1||y!=1||w!=1){this.scale(A,y,w)}if(z!=0||x!=0||v!=0){this.translate(z,x,v)}};this.identity=function(){this.initialize({n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1})};this.rotateX=function(u){var r=Math.sin(u);var t=Math.cos(u);this.concat(new Matrix3D(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1))};this.rotateY=function(u){var r=Math.sin(u);var t=Math.cos(u);this.concat(new Matrix3D(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1))};this.rotateZ=function(u){var r=Math.sin(u);var t=Math.cos(u);this.concat(new Matrix3D(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1))};this.setRotateAxis=function(r,u){var E=Math.cos(u);var B=Math.sin(u);var F=1-E;var D=r.x();var C=r.y();var A=r.z();var w=F*D;var v=F*C;this.concat(w*D+E,w*C-B*A,w*A+B*C,0,w*C+B*A,v*C+E,v*A-B*D,0,w*A-B*C,v*A+B*D,F*A*A+E,0,0,0,0,1)};this.scale=function(u,t,r){this.concat(new Matrix3D(u,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1))};this.translate=function(u,t,r){this.n41+=u;this.n42+=t;this.n43+=r};this.transformPoint=function(r){return new Vertex3D(this.n11*r.x+this.n21*r.y+this.n31*r.z+this.n41,this.n12*r.x+this.n22*r.y+this.n32*r.z+this.n42,this.n13*r.x+this.n23*r.y+this.n33*r.z+this.n43)};this.transformArray=function(t){var w=[];var A=t.length/3;for(var v=0;v<A;v++){var u=v*3;var r=t[u];var C=t[u+1];var B=t[u+2];w[u]=this.n11*r+this.n21*C+this.n31*B+this.n41;w[u+1]=this.n12*r+this.n22*C+this.n32*B+this.n42;w[u+2]=this.n13*r+this.n23*C+this.n33*B+this.n43}return w};this.getPosition=function(){return[this.n12,this.n13,this.n14]};this.setPosition=function(r){this.n12=r.x;this.n13=r.y;this.n14=r.z;return this},this.makeFrustum=function(t,F,r,C,v,u){var G={};var E=2*v/(F-t);var B=2*v/(C-r);var D=(F+t)/(F-t);var A=(C+r)/(C-r);var z=-(u+v)/(u-v);var w=-2*u*v/(u-v);G.n11=E;G.n12=0;G.n13=D;G.n14=0;G.n21=0;G.n22=B;G.n23=A;G.n24=0;G.n31=0;G.n32=0;G.n33=z;G.n34=w;G.n41=0;G.n42=0;G.n43=-1;G.n44=0;this.concat(G)};this.makePerspective=function(w,u,y,t){var r=y*Math.tan(w*Math.PI/360);var x=-r;var z=x*u;var v=r*u;this.makeFrustum(z,v,x,r,y,t)};this.makeOrtho=function(u,H,E,r,B,A){var I={};var G=H-u;var v=E-r;var t=A-B;var F=(H+u)/G;var D=(E+r)/v;var C=(A+B)/t;I.n11=2/G;I.n12=0;I.n13=0;I.n14=-F;I.n21=0;I.n22=2/v;I.n23=0;I.n24=-D;I.n31=0;I.n32=0;I.n33=-2/t;I.n34=-C;I.n41=0;I.n42=0;I.n43=0;I.n44=1;this.concat(I)};this.toString=function(){return this.n11+","+this.n12+","+this.n13+","+this.n14+","+this.n21+","+this.n22+","+this.n23+","+this.n24+","+this.n31+","+this.n32+","+this.n33+","+this.n34+","+this.n41+","+this.n42+","+this.n43+","+this.n44}};paper.Item.inject({radius:0,innerRadius:0,distanceToCenter:function(){var b=this.position.x-view.bounds.center.x;var a=this.position.y-view.bounds.center.y;return(b*b+a*a)+1},snapGrid:function(b){var a=new frederickkPaper.FPoint().snapGrid(b);this.position=a},snapIso:function(b){var a=new frederickkPaper.FPoint().snapIso(b);this.position=a}});paper.Path.inject({sec:function(a){return 1/Math.cos(a)},getCircumCircle:function(){if(this.segments.length==3){var c=this.segments[0].point;var b=this.segments[1].point;var a=this.segments[2].point;var t=b.x-c.x;var r=b.y-c.y;var q=a.x-c.x;var p=a.y-c.y;var o=t*(c.x+b.x)+r*(c.y+b.y);var n=q*(c.x+a.x)+p*(c.y+a.y);var m=2*(t*(a.y-b.y)-r*(a.x-b.x));var w;var l,k;if(Math.abs(m)<paper.EPSILON){function u(y,x,z){return(y>=x&&y>=z)?y:(x>=y&&x>=z)?x:z}function v(y,x,z){return(y<=x&&y<=z)?y:(x<=y&&x<=z)?x:z}var j=v(c.x,b.x,a.x);var i=v(c.y,b.y,a.y);var h=u(c.x,b.x,a.x);var g=u(c.y,b.y,a.y);w=new Point((j+h)/2,(i+g)/2);l=w.x-j;k=w.y-i}else{var e=(p*o-r*n)/m;var d=(t*n-q*o)/m;w=new Point(e,d);l=w.x-c.x;k=w.y-c.y}this.radius=Math.sqrt((l*l+k*k));return w}else{console.error("Not Path.FTriangle");return null}},getCentroid:function(){if(this.segments.length==3){var c=this.segments[0].point;var b=this.segments[1].point;var a=this.segments[2].point;return new Point((c.x+b.x+a.x)/3,(c.y+b.y+a.y)/3)}else{console.error("Not Path.FTriangle");return null}},statics:new function(){return{FArrow:function(g,c,k){var j=new Path(g,c);k=(k!=undefined)?k:new Size(g.getDistance(c)*0.381924,g.getDistance(c)*0.381924);var b=Math.atan2(g.x-c.x,c.y-g.y);var e=[];e[0]=new Path(new Point(0,0),new Point(-k.width,-k.height));e[1]=new Path(new Point(0,0),new Point(k.width,-k.height));for(var d=0;d<e.length;d++){e[d].rotate(180+frederickkPaper.degrees(b),new Point(0,0));e[d].translate(g)}var h=new Group(j,e[0],e[1]);h.name="arrow";return h},FBubble:function(h,b,j,i){var k=new Path();k.name="bubble";j=(j!=undefined)?j:defaultFBubbleTagSize;if(b.width<10){b.width=10;j=new Size(10,10)}i=(i!=undefined)?i:"RANDOM";k.add(new Point(0,0));var d=180;var a=new Point(b.height/2+Math.cos(f.radians(d))*(b.height),b.height/2+Math.sin(f.radians(d))*(b.height));k.arcTo(a,new Point(0,b.height));var c=frederickkPaper.randomInt(0,b.width-j.width);k.add(new Point(c,b.height));var g,e;if(i=="LEFT"){g=c}else{if(i=="CENTER"){g=c+(j.width/2)}else{if(i=="RIGHT"){g=c+j.width}else{g=frederickkPaper.randomInt(c,c+j.width)}}}e=b.height+j.height;k.add(new Point(g,e));k.add(new Point(c+j.width,b.height));k.add(new Point(b.width,b.height));d=0;a=new Point(b.height/2+Math.cos(f.radians(d))*(b.height/2),b.height/2+Math.sin(f.radians(d))*(b.height/2));k.arcTo(new Point(b.width,0),false);k.closed=true;k.position=new Point(h.x,h.y+(j.height/2));return k},FChain:function(i,h,g,e){var d,c;var j=f.getType(i);if(j=="Point"){d=new Path.Circle(i,h);c=new Path.Circle(g,e)}else{if(j=="Path"){d=i;c=h}else{return}}var k=frederickkPaper.getCommonTangents(d,c);if(k!=null){var l=new Path();l.name="chain";l.add(k[0]);l.add(k[1]);if(c.position.x>d.position.x){angle=0}else{if(c.position.y<d.position.y){angle=-90}else{if(c.position.y>d.position.y){angle=90}else{angle=180}}}var a=new Point(c.position.x+Math.cos(frederickkPaper.radians(angle))*(c.bounds.width/2),c.position.y+Math.sin(frederickkPaper.radians(angle))*(c.bounds.height/2));l.arcTo(a,k[2]);l.add(k[2]);l.add(k[3]);if(d.position.x>c.position.x){angle=0}else{if(d.position.y<c.position.y){angle=-90}else{if(d.position.y>c.position.y){angle=90}else{angle=180}}}var b=new Point(d.position.x+Math.cos(frederickkPaper.radians(angle))*(d.bounds.width/2),d.position.y+Math.sin(frederickkPaper.radians(angle))*(d.bounds.height/2));l.arcTo(b,k[0]);l.closed;return l}},FCross:function(h,d,g,c){(g!=undefined)?g:1;(c!=undefined)?c:"LINE";var b,a;if(c=="LINE"){b=new Path.Line(h.x+d.width,h.y-d.height,h.x-d.width,h.y+d.height);b.strokeWidth=g;a=new Path.Line(h.x+d.width,h.y+d.height,h.x-d.width,h.y-d.height);a.strokeWidth=g}else{if(c=="SHARP"){b=new Path();b.add(h.x+d.width,h.y-d.height);b.add(h.x+d.width,(h.y-d.height)+(g/2));b.add((h.x-d.width)+(g/2),h.y+d.height);b.add(h.x-d.width,h.y+d.height);b.add(h.x-d.width,(h.y+d.height)-(g/2));b.add((h.x+d.width)-(g/2),h.y-d.height);b.closed=true;a=new Path();a.add(h.x-d.width,h.y-d.height);a.add((h.x-d.width)+(g/2),h.y-d.height);a.add(h.x+d.width,(h.y+d.height)-(g/2));a.add(h.x+d.width,h.y+d.height);a.add((h.x+d.width)-(g/2),h.y+d.height);a.add(h.x-d.width,(h.y-d.height)+(g/2));a.closed=true}}var e=new Group(b,a);e.name="cross";return e},FDrop:function(d,a){var c=new Path();c.name="drop";c.add(new Segment(new Point(-0.01,0.01),new Point(0,-0.0055078),new Point(0,0.643042)));c.add(new Segment(new Point(-0.65,1.6381104),new Point(0,-0.6109619),new Point(0,0.3694434)));c.add(new Segment(new Point(0,2.31),new Point(-0.3578369,0),new Point(0.3578369,0)));c.add(new Segment(new Point(0.65,1.6381104),new Point(0,0.3694434),new Point(0,-0.6109619)));c.add(new Segment(new Point(0.01,0.01),new Point(0,0.643042),new Point(0,-0.0055078)));c.add(new Segment(new Point(0,-0),new Point(0.0055078,0),new Point(-0.0055078,0)));c.closed=true;c.position=d;var b=f.getType(a);if(b=="Size"){c.scale(a.width,a.height)}else{c.scale(a)}return c},FTriangle:function(d,c,a){var b=new Path();b.add(d);b.add(c);b.add(a);b.closed=true;b.name="triangle";return b}}}});frederickkPaper.FShape.FArrow=this.FArrow=Path.extend({initialize:function(b,a,c){return new paper.Path.FArrow(b,a,c)}});frederickkPaper.FShape.FBox=function(e){this.sides=new Array(6);this.vertices=[];this.name="";this.visible=true;this.selected=false;this.strokeCap;this.strokeJoin;this.faceFRONT=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,-0.5)];this.faceTOP=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,-0.5,-0.5)];this.faceBOTTOM=[new frederickkPaper.F3D.FPoint3(-0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,-0.5)];this.faceLEFT=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,-0.5)];this.faceRIGHT=[new frederickkPaper.F3D.FPoint3(0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,-0.5)];this.faceBACK=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,0.5)];var h=e;var d=[["front",this.faceFRONT],["top",this.faceTOP],["bottom",this.faceBOTTOM],["left",this.faceLEFT],["right",this.faceRIGHT],["back",this.faceBACK]];var j=[1,1,1,1,1,1];var a=["normal","normal","normal","normal","normal","normal"];var b=[new RgbColor(1,1,0,0.8),new RgbColor(1,0,1,0.8),new RgbColor(0,0,1,0.8),new RgbColor(1,0,0,0.8),new RgbColor(0,1,1,0.8),new RgbColor(0,1,0,0.8)];var g=[new RgbColor(1,1,0,0.8),new RgbColor(1,0,1,0.8),new RgbColor(0,0,1,0.8),new RgbColor(1,0,0,0.8),new RgbColor(0,1,1,0.8),new RgbColor(0,1,0,0.8)];var c=[1,1,1,1,1,1];var i=new frederickkPaper.F3D.FSize3(10,10,10);this.init=function(o,m,k){for(var n=0;n<d.length;n++){this.sides[n]=new frederickkPaper.F3D.FPath3();this.sides[n].name=d[n][0];this.vertices=d[n][1];for(var l=0;l<this.vertices.length;l++){this.sides[n].add3(new frederickkPaper.F3D.FPoint3(this.vertices[l].x*i.width,this.vertices[l].y*i.height,this.vertices[l].z*i.depth))}this.sides[n].opacity=j[n];this.sides[n].blendMode=a[n];this.sides[n].visible=this.visible;this.sides[n].selected=this.selected;this.sides[n].fillColor=b[n];this.sides[n].strokeColor=g[n];this.sides[n].strokeWidth=c[n];this.sides[n].strokeCap=this.strokeCap;this.sides[n].strokeJoin=this.strokeJoin;this.sides[n].closed=true;this.sides[n].translate(o,m,k);h.addItem(this.sides[n])}};this.setName=function(k){for(var l=0;l<d.length;l++){d[l][0]=k}};this.setSize=function(l,k,m){i.set(l,k,m)};this.setVisible=function(k){this.visible=k};this.setSelected=function(k){this.selected=k};this.setOpacity=function(k,l){if(k.length===undefined){j[k]=l}else{j=k}};this.setFillColor=function(l,k){if(l.length===undefined){b[l]=k}else{b=l}};this.setStrokeColor=function(l,k){if(l.length===undefined){g[l]=k}else{g=l}};this.setStrokeWidth=function(l,k){if(l.length===undefined){c[l]=k}else{c=l}};this.setStrokeCap=function(k){this.strokeCap=k};this.setStrokeJoin=function(k){this.strokeJoin=k};this.noFill=function(){b=[]};this.noStroke=function(){g=[]};this.get=function(){return this.sides};this.get=function(k){return this.sides[k]};this.getNumFaces=function(){return this.vertices.length-2};this.getSize=function(){return i}};frederickkPaper.FShape.FBubble=this.FBubble=Path.extend({initialize:function(a,c,d,b){return new paper.Path.FBubble(a,c,d,b)}});frederickkPaper.FShape.FChain=this.FChain=Path.extend({initialize:function(d,c,b,a){return new paper.Path.FChain(d,c,b,a)}});frederickkPaper.FShape.FCross=this.FCross=Path.extend({initialize:function(d,b,c,a){return new paper.Path.FCross(d,b,c,a)}});frederickkPaper.FShape.FDrop=this.FDrop=Path.extend({initialize:function(b,a){return new paper.Path.FDrop(b,a)}});frederickkPaper.FShape.FSphere=function(e){this.sides=[];this.vertices=[];this.name="";this.visible=true;this.selected=false;this.strokeCap;this.strokeJoin;var i=e;var h=10;var j=0.5;var c;var l;var k=[];var a=[];var b=[];var g=[];var d=[];this._calculate=function(G,m){this.vertices=[];for(var t=0;t<=G;t++){var u=(Math.PI*(-j+((t-1)/G)));var w=Math.sin(u);var E=Math.cos(u);var q=(Math.PI*(-j+(t/G)));var r=Math.sin(q);var C=Math.cos(q);for(var o=0;o<=m;o++){var B=((Math.PI*2)*((o-1)/m));var D=Math.cos(B);var A=Math.sin(B);this.vertices.push(new frederickkPaper.F3D.FPoint3(D*E,A*E,w));this.vertices.push(new frederickkPaper.F3D.FPoint3(D*C,A*C,r))}}this.sides=new Array(this.vertices.length-2);k=new Array(this.vertices.length-2);a=new Array(this.vertices.length-2);b=new Array(this.vertices.length-2);g=new Array(this.vertices.length-2);d=new Array(this.vertices.length-2);var z=this.vertices.length-2;for(var t=0;t<z;t++){var F=this.vertices[t];var n=new HslColor(360*t/z,0.9,0.7);var p=(F.z/e.getFocalLength())*100;k[t]=1;a[t]="normal";b[t]=n.darken(p);g[t]=n.darken(p);d[t]=1}};this.init=function(p,n,m){if(c==null){this.setLatsLongs(6,6)}for(var o=0;o<this.vertices.length-2;o++){this.sides[o]=new frederickkPaper.F3D.FPath3();this.sides[o].name="face"+o;this.sides[o].add3(new frederickkPaper.F3D.FPoint3(this.vertices[o].x*(h*0.5),this.vertices[o].y*(h*0.5),this.vertices[o].z*(h*0.5)));this.sides[o].add3(new frederickkPaper.F3D.FPoint3(this.vertices[o+1].x*(h*0.5),this.vertices[o+1].y*(h*0.5),this.vertices[o+1].z*(h*0.5)));this.sides[o].add3(new frederickkPaper.F3D.FPoint3(this.vertices[o+2].x*(h*0.5),this.vertices[o+2].y*(h*0.5),this.vertices[o+2].z*(h*0.5)));this.sides[o].opacity=k[o];this.sides[o].blendMode=a[o];this.sides[o].visible=this.visible;this.sides[o].selected=this.selected;this.sides[o].fillColor=b[o];this.sides[o].strokeColor=g[o];this.sides[o].strokeWidth=d[o];this.sides[o].strokeCap=this.strokeCap;this.sides[o].strokeJoin=this.strokeJoin;this.sides[o].closed=true;this.sides[o].translate(p,n,m);e.addItem(this.sides[o])}};this.setSize=function(m){h=m};this.setLatsLongs=function(n,m){c=(n<4)?4:n;l=(m<4)?4:m;this._calculate(c,l)};this.setVisible=function(m){this.visible=m};this.setSelected=function(m){this.selected=m};this.setOpacity=function(m,n){if(m.length===undefined){k[m]=n}else{k=m}};this.setFillColor=function(p,n){if(p.length===undefined){b[p]=n}else{for(var o=0;o<p.length;o++){var m=this.vertices[o];var q=(m.z/e.getFocalLength())*100;b[o]=p.darken(q)}}};this.setStrokeColor=function(p,n){if(p.length===undefined){g[p]=n}else{for(var o=0;o<p.length;o++){var m=this.vertices[o];var q=(m.z/e.getFocalLength())*100;g[o]=p.darken(q)}}};this.setStrokeWidth=function(n,m){if(n.length===undefined){d[n]=m}else{d=n}};this.setStrokeCap=function(m){this.strokeCap=m};this.setStrokeJoin=function(m){this.strokeJoin=m};this.noFill=function(){b=[]};this.noStroke=function(){g=[]};this.setVertices=function(m,n){if(m.length===undefined){this.vertices[m]=n}else{this.vertices=m}};this.get=function(){return this.sides};this.get=function(m){return this.sides[m]};this.getNumFaces=function(){return this.vertices.length-2};this.getVertices=function(){return this.vertices};this.getSize=function(){return h}};frederickkPaper.FShape.FTriangle=this.FTriangle=Path.extend({initialize:function(c,b,a){return new paper.Path.FTriangle(c,b,a)}});frederickkPaper.FControl=function(a){this.divId=a;this.addCheck=function(c,d){var b=document.createElement("input");b.setAttribute("type","chackbox");b.setAttribute("value",d);b.setAttribute("name",c);var e=document.createElement("div");e.appendChild(b);var g=document.getElementById(this.divId);g.appendChild(e)};this.addInput=function(c,d){var b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("className","txt");b.setAttribute("value",d);b.setAttribute("name",c);var e=document.createElement("div");e.appendChild(b);var g=document.getElementById(this.divId);g.appendChild(e)}};